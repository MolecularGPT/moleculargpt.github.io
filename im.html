<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BIOLOCK: Симулятор Иматиниба (1IEP)</title>
    <!-- Подключение библиотек -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="https://ajax.googleapis.com"></script>
    <link href="https://fonts.googleapis.com" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #05070a;
            --glass-bg: rgba(15, 23, 42, 0.7);
            --neon-blue: #38bdf8;
            --neon-green: #22c55e;
            --neon-orange: #f97316;
        }

        body {
            background-color: var(--bg-color);
            color: #e2e8f0;
            font-family: 'Roboto Condensed', sans-serif;
            margin: 0;
            overflow: hidden;
            height: 100vh;
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        /* Стеклянный эффект панелей */
        .glass-panel {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 100;
        }

        /* Анимация пульсации для ошибок */
        .pulse-red {
            animation: pulse-red-anim 2s infinite;
        }
        @keyframes pulse-red-anim {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        /* Контейнер модели */
        .model-viewer-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
        }

        model-viewer {
            width: 100%;
            height: 100%;
            --poster-color: transparent;
        }

        /* Кастомный скроллбар для списков */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
    </style>
</head>
<body>

    <!-- ЛЕВАЯ ПАНЕЛЬ: НАВИГАТОР -->
    <div class="fixed top-6 left-6 w-80 space-y-4 pointer-events-none">
        <div class="glass-panel p-6 rounded-3xl pointer-events-auto border-l-4 border-blue-500">
            <div class="flex items-center justify-between mb-4">
                <span class="text-[10px] text-blue-400 mono tracking-widest uppercase">Объект: 1IEP</span>
                <span class="bg-blue-500/20 text-blue-400 text-[9px] px-2 py-0.5 rounded border border-blue-500/30">LIGAND-FIT</span>
            </div>
            
            <h1 class="text-2xl font-bold tracking-tight uppercase italic text-white">ИМАТИНИБ</h1>
            <p class="text-xs text-gray-400 mt-1">Мишень: Abl-киназа (Тип Дикий)</p>

            <div class="mt-6 space-y-4">
                <div class="space-y-2">
                    <div class="flex justify-between text-[10px] uppercase text-gray-500">
                        <span>Прогресс захвата кармана</span>
                        <span>65%</span>
                    </div>
                    <div class="h-1 bg-gray-800 rounded-full">
                        <div class="h-full bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.5)]" style="width: 65%"></div>
                    </div>
                </div>

                <div class="grid grid-cols-1 gap-2 pt-2">
                    <div class="flex items-center text-[11px] text-green-400/80 space-x-2">
                        <div class="w-1.5 h-1.5 rounded-full bg-green-500"></div>
                        <span>DFG-Out Конформация найдена</span>
                    </div>
                    <div class="flex items-center text-[11px] text-gray-500 space-x-2">
                        <div class="w-1.5 h-1.5 rounded-full bg-gray-600"></div>
                        <span>H-связь Met318: Ожидание...</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="glass-panel p-4 rounded-2xl pointer-events-auto space-y-2">
            <button class="w-full py-2 bg-blue-600/10 hover:bg-blue-600/30 border border-blue-500/30 rounded-xl text-[11px] uppercase mono transition-all text-blue-300">Встряхнуть (Jiggle)</button>
            <button class="w-full py-2 bg-purple-600/10 hover:bg-purple-600/30 border border-purple-500/30 rounded-xl text-[11px] uppercase mono transition-all text-purple-300">Минимизировать энергию</button>
        </div>
    </div>

    <!-- ПРАВАЯ ПАНЕЛЬ: АНАЛИЗАТОР -->
    <div class="fixed top-6 right-6 w-84 space-y-4 pointer-events-none">
        <div class="glass-panel p-6 rounded-3xl pointer-events-auto border-r-4 border-cyan-500">
            <div class="text-right mb-6">
                <p class="text-[10px] text-gray-500 uppercase mono">Общий счет Rosetta</p>
                <div id="score" class="text-6xl font-bold text-cyan-400 mono leading-none tracking-tighter">0</div>
                <div class="text-green-400 text-xs mono mt-1">▲ +450.2 (Delta)</div>
            </div>

            <div class="space-y-5">
                <!-- VdW -->
                <div class="space-y-1">
                    <div class="flex justify-between text-[10px] uppercase tracking-wider text-gray-400">
                        <span>Упаковка VdW</span>
                        <span class="text-white">11,200</span>
                    </div>
                    <div class="h-1 w-full bg-gray-800 rounded-full">
                        <div class="h-full bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.5)]" style="width: 93%"></div>
                    </div>
                </div>

                <!-- H-Bonds -->
                <div class="space-y-1">
                    <div class="flex justify-between text-[10px] uppercase tracking-wider text-gray-400">
                        <span>H-Связи</span>
                        <span class="text-white">8 / 8</span>
                    </div>
                    <div class="h-1 w-full bg-gray-800 rounded-full overflow-hidden">
                        <div class="h-full bg-cyan-400 shadow-[0_0_8px_rgba(34,211,238,0.5)]" style="width: 100%"></div>
                    </div>
                </div>

                <!-- AI confidence -->
                <div class="bg-blue-500/5 rounded-2xl p-3 border border-blue-500/20 flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 rounded-full border-2 border-blue-400 border-t-transparent animate-spin"></div>
                        <span class="text-[11px] text-blue-300 uppercase mono">AlphaFold 3 <br>Confidence</span>
                    </div>
                    <span class="text-xl font-bold text-blue-400 mono">0.98</span>
                </div>
            </div>

            <!-- Alerts -->
            <div class="mt-6 pt-4 border-t border-gray-800">
                <div class="flex items-center space-x-2 text-red-500 bg-red-500/10 p-2 rounded-lg pulse-red border border-red-500/20">
                    <div class="w-1.5 h-1.5 bg-red-500 rounded-full"></div>
                    <span class="text-[10px] uppercase font-bold">Столкновение: THR315 (-250)</span>
                </div>
            </div>
        </div>
    </div>

    <!-- КОНТЕЙНЕР МОДЕЛИ -->
    <div class="model-viewer-container">
        <model-viewer 
            src="https://tripreport.github.io/1IEP_mol.glb"
            alt="3D модель молекулы Иматиниба"
            auto-rotate
            camera-controls
            touch-action="pan-y"
            shadow-intensity="1"
            exposure="0.8"
            environment-image="neutral"
            ar
            ar-modes="webxr scene-viewer quick-look"
        >
            <!-- Тултипы/Hotspots для игры -->
            <button class="hotspot" slot="hotspot-h-bond" data-position="0.1 0.1 0.1" data-normal="0 0 1">
                <div class="bg-cyan-500 w-3 h-3 rounded-full animate-ping"></div>
            </button>
        </model-viewer>
    </div>

    <!-- ФУТЕР -->
    <div class="fixed bottom-6 left-1/2 -translate-x-1/2 glass-panel px-6 py-2 rounded-full text-[10px] mono text-gray-500 uppercase tracking-[0.3em]">
        Свободная энергия -13.5 ккал/моль
    </div>

    <script>
        // Анимация счётчика очков
        const scoreTarget = 16500;
        const duration = 2500;
        const scoreEl = document.getElementById('score');
        let start = null;

        function animate(timestamp) {
            if (!start) start = timestamp;
            const progress = Math.min((timestamp - start) / duration, 1);
            const val = Math.floor(progress * scoreTarget);
            scoreEl.textContent = val.toLocaleString();
            if (progress < 1) requestAnimationFrame(animate);
        }
        
        requestAnimationFrame(animate);

        // Интерактив для кнопок (визуальный эффект)
        document.querySelectorAll('button').forEach(btn => {
            btn.addEventListener('mousedown', () => {
                btn.style.transform = 'scale(0.98)';
            });
            btn.addEventListener('mouseup', () => {
                btn.style.transform = 'scale(1)';
            });
        });
    </script>
</body>
</html>
